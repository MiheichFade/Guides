# Как использовать VirtualBox в ОС Windows  


## Общие сведения  


**VirtualBox** — это бесплатное программное обеспечение для виртуализации, 
позволяющее запускать на одном физическом устройстве несколько операционных систем одновременно. 
**VirtualBox** создает виртуальные машины — изолированные виртуальные среды, 
которые работают как отдельные "мини-компьютеры" внутри основного устройства.  

Виртуализация предполагает использование двух видов операционных систем:  

- Хостовая <span style="color: #6a8ed0;" title="операционная система">ОС</span> — это основная операционная система, 
установленная на физическом устройстве, которая управляет **VirtualBox**.  

- Гостевая ОС — это операционная система, установленная на виртуальной машине, 
которая работает независимо от хостовой ОС и изолирована от нее.  

Использование **VirtualBox** предоставляет следующие возможности:  

- Экономия ресурсов и удобство настройки.  

    > <span style="color: #6a8ed0;" title="виртуальная машина">ВМ</span> позволяют работать с несколькими ОС на одном устройстве 
    > без необходимости дополнительного оборудования. ВМ легко настраиваются и 
    > позволяют пользователям быстро переключаться между системами.  

- Изоляция процессов.  

    > Программы и процессы, выполняемые на ВМ, изолированы от основной системы, 
    > что предотвращает риск воздействия на хостовую ОС.  

- Тестирование и разработка.  

    > ВМ отлично подходят для тестирования ПО или изменений в системных настройках 
    > без риска повлиять на работу основной системы.  

В данном руководстве для примера установки и настройки **VirtualBox** в качестве хостовой ОС используется **Windows 10**, 
а в качестве гостевой — **Ubuntu 22**.  

---  


## Установка VirtualBox


Для установки **VIrtualBox** необходимо выполнить следующие шаги:  

1. Перейти на [официальный сайт разработчика](https://www.virtualbox.org/).  

1. Нажать <span style="border:2px solid #555; border-radius:5px; width: 200px; text-align:center; padding:3px;">Download</span>.  

1. На открывшейся странице в разделе **VirtualBox Platform Packages** нажать на ссылку [**Windows hosts**](https://download.virtualbox.org/virtualbox/7.1.4/VirtualBox-7.1.4-165100-Win.exe) для загрузки установочного файла.  

1. Дождаться завершения загрузки.  

1. Открыть файл `VirtualBox-{version}-Win.exe`.  

1. На этапе **Welcome to the Oracle VirtualBox Setup Wizard** нажать 
<span style="border:2px solid #555; border-radius:0px; width: 200px; text-align:center; padding:3px;">Next ></span>.  

1. На этапе **End-User License Agreement** необходимо ознакомиться с лицензионным соглашением. 
Для его подтверждения следует выбрать **I accept the terms in the License Agreement** и 
нажать <span style="border:2px solid #555; border-radius:0px; width: 200px; text-align:center; padding:3px;">Next ></span>.  

1. На этапе **Custom Setup** имеется возможность выбора дополнительных компонентов, доступных к установке:  

    - VirtualBox Application (_Обязателен к установке_)  

        > Основная программа, управляющая ВМ и обеспечивающая доступ ко всем функциям **VirtualBox**.  

        - VirtualBox USB Support  

            > Позволяет подключать USB-устройства (например, flash-накопители, принтеры или камеры) напрямую к ВМ.  

        - VirtualBox Networking  

            > Сетевые компоненты, обеспечивающие ВМ подключением к сети:  

            - VirtualBox Bridged Networking  

                > Позволяет ВМ напрямую подключаться к сети как отдельное физическое устройство.  

            - VirtualBox Host-Only Networking  

                > Создает изолированную сеть, доступную только для хоста и ВМ.  
        
        - VirtualBox Python Support

            > Компонент, добавляющий поддержку скриптов на языке Python для автоматизации действий с ВМ.  
            > 
            > Этот компонент полезен для разработчиков или системных администраторов, 
            > которым необходимо выполнять автоматизированные задачи (например, создание или удаление ВМ, 
            > настройка параметров) с использованием Python API VirtualBox.  

    Для исключения компонента из установки следует нажать на ![img](./_assets/component.jpeg) 
    рядом с его наименованием и выбрать **Entire feature will be unavailable**.  

    Также на этапе **Custom Setup** имеется возможность выбрать путь установки **VirtualBox**. 
    Для его изменения необходимо нажать 
    <span style="border:2px solid #555; border-radius:0px; width: 200px; text-align:center; padding:3px;">Browse</span>,
    в открывшемся окне выбрать директорию, предпочитаемую для установки **VirtualBox**, и нажать 
    <span style="border:2px solid #555; border-radius:0px; width: 200px; text-align:center; padding:3px;">ОК</span>.  

    Рекомендуется оставить все установленные по умолчанию значения без изменений.  

    Для перехода на следующий этап необходимо нажать 
    <span style="border:2px solid #555; border-radius:0px; width: 200px; text-align:center; padding:3px;">Next ></span>.  

1. Если на этапе установки дополнительных компонентов был выбран **VirtualBox Bridged Networking**, 
установщик предупредит о временном отключении устройства от сети для конфигурации сетевых интерфейсов. 
Необходимо согласиться с продолжением установки, нажав 
<span style="border:2px solid #555; border-radius:0px; width: 200px; text-align:center; padding:3px;">Yes</span>.  

1. Если на этапе установки дополнительных компонентов был выбран **VirtualBox Python Support**, 
установщик проверит наличие зависимостей **Python Core** и **win32api**. 
В случае их отсутствия появится предупреждение о необходимости их самостоятельной настройки. 
Следует согласиться с продолжением установки, нажав 
<span style="border:2px solid #555; border-radius:0px; width: 200px; text-align:center; padding:3px;">Yes</span>.  

    > Подробнее о средствах разработки [**VirtualBox SDK**](http://download.virtualbox.org/virtualbox/SDKRef.pdf).  

1. На следующем этапе установки предлагается:  

    - Create start menu entries

        > Добавить ярлыки **VirtualBox** в меню **Пуск**.  

    - Create a shortcut on the desktop

        > Создать ярлык **VirtualBox** на рабочем столе.  

    - Create a shortcut in the Quick Launch Bar

        > Создать ярлык **VirtualBox** на панели быстрого запуска.  

    - Register file association

        > Зарегистрировать файлы формата `.vbox` (конфигурационные файлы виртуальных машин **VirtualBox**) в системе, 
        > чтобы они автоматически запускались в **VirtualBox** при открытии.  

    Рекомендуется оставить все установленные по умолчанию значения без изменений.  

    Для перехода на следующий этап установки необходимо нажать 
    <span style="border:2px solid #555; border-radius:0px; width: 200px; text-align:center; padding:3px;">Next ></span>.  

1. На этапе **Ready to Install** нажать 
<span style="border:2px solid #555; border-radius:0px; width: 200px; text-align:center; padding:3px;">Install</span> 
для запуска процесса установки.  

1. Дождаться завершения установки.  

1. В открывшемся окне включить опцию **Start Oracle VirtualBox after installation** и нажать 
<span style="border:2px solid #555; border-radius:0px; width: 200px; text-align:center; padding:3px;">Finish</span>.  

Приложение успешно установлено, если после завершения процесса был автоматически запущен **VirtualBox**.  

---  


## Создание виртуальной машины  


> Рекомендуется заранее загрузить на хостовую машину ISO-образ гостевой ОС. 
> В данном руководстве используется ОС [**Ubuntu 22.04.5 LTS**](https://releases.ubuntu.com/jammy/).  

Для создания ВМ необходимо выполнить следующие шаги:  

1. Перейти на главный экран **VirtualBox**.  

1. Нажать <span style="border:2px solid #555; border-radius:0px; width: 200px; text-align:center; padding:3px;">Создать</span>.  

1. В открывшемся окне заполнить следующие поля:  

    - Имя

        > Название создаваемой ВМ.  

    - Папка

        > Директория, в которой будут храниться конфигурационные файлы ВМ.  

    - Образ ISO _(Необязательное поле)_  

        > ISO-образ операционной системы, устанавливаемой на ВМ.  
        > 
        > Если оставить поле **Образ ISO** пустым, ВМ будет создана, 
        > но для работы с ней в дальнейшем потребуется установка ОС.  

    - Редакция  

        > При наличии в ISO-образе нескольких версий ОС, необходимо выбрать предпочтительную для установки.  

    - Тип  

        > Тип ОС (например, **Linux**).  

    - Подтип  

        > Подтип ОС (например, **Ubuntu**).  

    - Версия  

        > Версия ОС (например, **Ubuntu (64-bit)**).  

    - <a name="auto_install"></a>Пропустить автоматическую установку  

        > Если опция активна, автоматическая установка ОС при первом запуске ВМ будет пропущена.  
        > 
        > _Доступно только если указан ISO-образ._  

    После заполнения всех указанных полей необходимо нажать 
    <span style="border:2px solid #555; border-radius:0px; width: 200px; text-align:center; padding:3px;">Далее</span>.      

1. Если на предыдущем этапе создания ВМ была выбрана автоматическая установка ОС, потребуется заполнить 
следующие поля:  

    - Имя пользователя  

    - Пароль  

    - Подтвердите пароль  

    - Ключ продукта _(Необязательное поле)_  

        > Ключ активации (только для ОС **Windows**).  
    
    - Имя ПК  

        > Уникальное название ВМ в сети.  

    - Доменное имя  

        > Общее имя для группы устройств в сети (например, `mycompany.local`).  

    - Фоновая установка  

        > Установка гостевой ОС пройдет в фоновом режиме без  использования графического интерфейса.  

    - <a name="auto_install_guestadd"></a>Дополнения гостевой ОС  

        > После установки ОС будут установлены гостевые дополнения **VBox Guest Additions**.  
        > 
        > [Подробнее о гостевых дополнениях](#гостевые-дополнения).  

    После заполнения всех указанных полей следует нажать 
    <span style="border:2px solid #555; border-radius:0px; width: 200px; text-align:center; padding:3px;">Далее</span>.    

1. На этапе **Оборудование** необходимо заполнить следующие поля:  

    - Основная память  

        > Объем оперативной памяти (<span style="color: #6a8ed0;" title="Random Access Memory">RAM</span>), выделяемый для ВМ.  
        > Рекомендуется выделять не более половины от общей оперативной памяти на все ВМ, чтобы сохранить стабильность работы хостовой системы.  

    - Процессоры  

        > Количество ядер процессора, которое будет использовать ВМ.  
        > Рекомендуется выделять не более половины от общего количества ядер на все ВМ, чтобы сохранить стабильность работы хостовой системы.  

    - Включить EFI (только специальные ОС)  

        > Этот параметр необходим для ОС, 
        > которые поддерживают загрузку только через <span style="color: #6a8ed0;" title="Extensible Firmware Interface">EFI</span>.  

    После заполнения всех необходимых полей необходимо нажать 
    <span style="border:2px solid #555; border-radius:0px; width: 200px; text-align:center; padding:3px;">Далее</span>.  

1. На этапе **Виртуальный жесткий диск** следует задать параметры создаваемого диска. 
Возможен один из вариантов создания:  

    - Создать новый виртуальный жесткий диск  

        > Позволяет создать новый диск, который будет использоваться для хранения данных внутри ВМ.  

        - Размер диска  

            > Объем диска гостевой ОС, выделяемый на физическом диске хоста.  
            > 
            > _Для ОС **Ubuntu** рекомендуется выделять не менее 25 ГБ._  

        - Выделить место в полном размере  
        
            > Если опция включена, **VirtualBox** выделит на физическом диске хоста весь указанный объем для 
            > виртуального диска сразу (режим "толстого" диска).  
            > 
            > Если опция выключена, **VirtualBox** будет выделять место по мере необходимости, 
            > не резервируя место на хостовой системе (режим "тонкого" диска).  
            > _Данный формат является рекомендуемым._  

    - Использовать существующий виртуальный жесткий диск  
    
        > Позволяет выбрать существующий виртуальный диск для подключения к ВМ.  
    
    - Не подключать виртуальный жесткий диск  
    
        > ВМ создается без жесткого диска. Его добавление возможно после создания ВМ.  

    После заполнения всех указанных полей необходимо нажать 
    <span style="border:2px solid #555; border-radius:0px; width: 200px; text-align:center; padding:3px;">Далее</span>.  

1. На этапе **Итог** следует проверить корректность информации о создаваемой ВМ. 
Если все данные верны, необходимо нажать 
<span style="border:2px solid #555; border-radius:0px; width: 200px; text-align:center; padding:3px;">Готово</span>.  

---  


## Установка гостевой ОС  


Установка гостевой ОС возможна двумя способами: автоматически и вручную.  

Автоматическая установка гостевой ОС начнется сразу же после завершения этапа создания ВМ, если такая опция была выбрана [ранее](#auto_install).  

В ином случае следует установить гостевую ОС самостоятельно. Для этого необходимо:  

1. В интерфейсе **VirtualBox** нажать левой кнопкой "мыши" на созданную ВМ.  

1. Нажать **Настройки**.  

1. Перейти в раздел **Носители**.  

1. Убедиться, что оптический привод в устройстве **Контроллер: IDE** содержит ISO-образ гостевой ОС и нажать 
<span style="border:2px solid #555; border-radius:0px; width: 200px; text-align:center; padding:3px;">ОК</span>.  

    Если это не так, необходимо:  
    
    1. Выбрать пустой оптический привод, нажав на ![img](./_assets/empty_drive.jpeg).  

    1. Нажать на ![img](./_assets/choose_drive.jpeg).  

    1. Нажать **Выбрать файл диска**.  

    1. В открывшемся окне найти ISO-образ нужной гостевой ОС, выбрать его и нажать 
    <span style="border:2px solid #555; border-radius:0px; width: 200px; text-align:center; padding:3px;">Открыть</span>.  

    1. Нажать <span style="border:2px solid #555; border-radius:0px; width: 200px; text-align:center; padding:3px;">ОК</span>.  

1. Нажать **Запустить**.  

1. После старта ВМ загрузчик предложит несколько вариантов запуска. Необходимо выбрать **Try or Install Ubuntu** и нажать на клавишу **Enter**.  

    > На данном этапе "мышь" недоступна. Управление осуществляется с помощью клавиатуры.  

1. В открывшемся окне с интерфейсом **Ubuntu** на этапе **Добро пожаловать** необходимо выбрать язык системы и нажать 
<span style="border:2px solid #555; border-radius:8px; width: 200px; text-align:center; padding:3px;">Установить Ubuntu</span>.  

1. На следующем этапе необходимо выбрать язык и раскладку клавиатуры. Нажать 
<span style="border:2px solid #555; border-radius:8px; width: 200px; text-align:center; padding:3px;">Продолжить</span>.  

    > _Для стандартной русской раскладки рекомендуется выбрать **Russian - Russian**._  

1. На этапе **Обновления и другие программы** необходимо выбрать **Обычная установка** и **Загрузить обновления во время установки Ubuntu**.  

1. Нажать <span style="border:2px solid #555; border-radius:8px; width: 200px; text-align:center; padding:3px;">Продолжить</span>.  

1. На этапе **Тип установки** следует выбрать **Стереть диск и установить Ubuntu** и 
нажать <span style="border:2px solid #555; border-radius:8px; width: 200px; text-align:center; padding:3px;">Установить сейчас</span>.  

1. Ознакомиться с информацией об изменении разделов виртуального диска ВМ и нажать 
<span style="border:2px solid #555; border-radius:8px; width: 200px; text-align:center; padding:3px;">Продолжить</span>.  

1. На следующем этапе необходимо указать город для определения часового пояса и нажать 
<span style="border:2px solid #555; border-radius:8px; width: 200px; text-align:center; padding:3px;">Продолжить</span>.  

1. Далее следует заполнить поля:  

    - Ваше имя  

    - Имя вашего компьютера  

        > Имя ВМ в сети.  

    - Введите имя пользователя  

        > Имя учетной записи в системе.  

    - Задайте пароль  

    - Подтвердите пароль  

    - Входить в систему автоматически / Требовать пароль для входа в систему  

        > При включенной опции **Входить в систему автоматически** ВМ позволит загружаться в учетную запись без пароля.  
        > 
        > При включенной опции **Требовать пароль для входа в систему** ВМ будет каждый раз запрашивать пароль при входе.  
        > _Рекомендуется для дополнительной безопасности._  

    - Задействовать Active Directory  

        > Подключение к серверу <span style="color: #6a8ed0;" title="Active Directory">AD</span>.  
        > _Отключить, если AD не используется._  

    После заполнения всех указанных полей необходимо нажать 
    <span style="border:2px solid #555; border-radius:8px; width: 200px; text-align:center; padding:3px;">Продолжить</span>.  

1. Дождаться завершения установки ОС.  

---  


## Дополнительные настройки  


### Гостевые дополнения  


**Гостевые дополнения** (**Guest Additions**) — это набор драйверов и инструментов, разработанных для улучшения работы гостевой ОС. 
Гостевые дополнения дают несколько основных преимуществ:  

- Поддержка общего буфера обмена  

    > Позволяет копировать текст, файлы и другие данные между хостовой и гостевой ОС.  

- Автоматическое масштабирование экрана  

    > Позволяет автоматически изменять разрешение экрана гостевой ОС при изменении размера окна **VirtualBox**.  

- Общие папки  

    > Позволяет создавать папки, доступные как из хостовой системы, так и из гостевой.  

Установка гостевых дополнений доступна при [настройке автоматической установки гостевой ОС](#auto_install_guestadd), а также вручную.  

Для установки гостевых дополнений на ОС **Ubuntu** необходимо:  

1. Перейти к включенной ВМ.  

1. В верхней панели окна **VirtualBox** в разделе **Устройства** нажать 
<span style="border:2px solid #555; border-radius:0px; width: 200px; text-align:center; padding:3px;">Подключить образ Дополнений гостевой ОС</span>.  

1. Открыть терминал гостевой ОС нажатием комбинации клавиш клавиатуры `Ctrl` + `Alt` + `T`.  

1. Выполнить команду:  

    ```
    sudo /media/$USER/VBox_GAs_*/VBoxLinuxAdditions.run
    ```  

1. Подтвердить выполнение команды вводом пароля.  

1. Дождаться завершения установки.  

1. Перезагрузить ВМ.  

> После установки гостевых дополнений и перезагрузки ВМ начнет работать автоматическое масштабирование экрана — 
> при изменении размеров окна **VirtualBox**, экран гостевой ОС будет масштабироваться вместе с ним.  

---  


### Общий буфер обмена  


Общий буфер обмена позволяет копировать текст, файлы и другие данные между хостовой и гостевой ОС.  

> Данная функция работает только при установленных [гостевых дополнениях **VirtualBox**](#гостевые-дополнения).  

Для активации общего буфера обмена необходимо:  

1. Перейти к включенной ВМ.  

1. В верхней панели окна **VirtualBox** в разделе **Устройства - Общий буфер обмена** нажать 
<span style="border:2px solid #555; border-radius:0px; width: 200px; text-align:center; padding:3px;">Двунаправленный</span>.  

    > Дополнительно рекомендуется включить опции **Разрешить передачу файлов** и **Drag and Drop** для копирования файлов 
    > с гостевой ОС на хостовую (и наоборот) с помощью буфера обмена и путем перетаскивания их с помощью "мыши".  

---  


### Настройка общих папок  


Общие папки позволяют передавать файлы между хостовой и виртуальной машинами.  

> Данная функция работает только при установленных [гостевых дополнениях **VirtualBox**](#гостевые-дополнения).  

Для активации функционала общих папок необходимо:  

1. Перейти на главный экран **VirtualBox**.  

1. Выбрать ВМ и нажать **Настроить**.  

1. В открывшемся окне перейти в раздел **Общие папки**.  

1. Нажать на ![img](./_assets/dir.jpeg).  

1. В открывшемся окне заполнить следующие поля:  

    - Путь к папке  

        > Путь к папке на хостовой ОС, в которой будут храниться общие файлы.  

    - Имя папки  

        > Имя папки, которое будет отображаться в гостевой ОС.  
        > 
        > Например, `shared_host`.  

    - Точка подключения  

        > Место в файловой системе гостевой ОС, где будет отображаться общая папка.  
        > 
        > Например, `/home/{username}/Документы/shared_host`,  
        > где `{username}` — имя пользователя гостевой ОС.  

    - Только для чтения  

        > Если опция включена, то ВМ сможет только просматривать содержимое папки, но не изменять его.  

    - Авто-подключение  

        > Если опция включена, то общая папка автоматически будет подключаться каждый раз при запуске ВМ.  
        > 
        > _Рекомендуется включить._  

    - Создать постоянную папку  

        > Если опция включена, папка будет сохраняться как постоянная, доступ к которой будет возможен при каждом запуске ВМ.  
        > 
        > _Рекомендуется включить._

1. Нажать <span style="border:2px solid #555; border-radius:0px; width: 200px; text-align:center; padding:3px;">ОК</span>.  

---  


### Конфигурация сети  


**VirtualBox** предлагает несколько типов сетевых адаптеров, которые можно настроить для ВМ. 
Каждый из них имеет свои особенности и подходит для различных сценариев использования:  

- NAT  

    > С помощью <span style="color: #6a8ed0;" title="Network Address Translation">NAT</span> ВМ получает доступ к сети Интернет через IP-адрес хостовой машины.  

- Сетевой мост  

    > ВМ подключается к той же сети, что и хостовая система. 
    > Она получает собственный IP-адрес от маршрутизатора и становится полноценным участником сети.  

- Внутренняя сеть  

    > ВМ, подключенные к одной внутренней сети, могут обмениваться данными друг с другом, 
    > но при этом не имеют доступа ни к сети Интернет, ни к хостовой системе.  

- Host-Only  

    > Создает изолированную сеть между хостом и ВМ. 
    > Они могут взаимодействовать друг с другом, но ВМ не имеет доступа к внешней сети.  

- Виртуальный адаптер  

    > Программное сетевое устройство, позволяющее ВМ подключаться к сети, имитируя работу физической сетевой карты.  

- Универсальный драйвер  

    > Предоставляет полный доступ к настройкам сетевого подключения на уровне сетевого интерфейса 
    > (подключение к нестандартным сетевым интерфейсам, использование нестандартных протоколов и др.)  

- Сеть NAT  

    > Сеть NAT расширяет стандартный режим NAT, 
    > позволяя нескольким ВМ взаимодействовать друг с другом в одной подсети и делить один общий IP-адрес хоста для доступа к сети Интернет.  

- Облачная сеть (экспериментально)

    > Позволяет подключать ВМ к сети облачной инфраструктуры, где они могут взаимодействовать с другими облачными ресурсами.  

- Не подключен  

    > ВМ не имеет сетевого подключения и не может обмениваться данными с хостом или другими устройствами.  

Для настройки сетевого подключения ВМ необходимо:  

1. Перейти на главный экран **VirtualBox**.  

1. Выбрать ВМ и нажать **Настроить**.  

1. В открывшемся окне перейти в раздел **Сеть**.  

1. Заполнить следующие поля:  

    - Тип подключения  

        > Подробнее о типах подключения описано выше в текущем разделе.  
        > 
        > _Рекомендуется выбрать тип **Сетевой мост**._  

    - Имя  

        > Выбор сетевого адаптера хоста (или сети), через который пойдет трафик ВМ.  
        > 
        > _При выборе типа подключения **Сетевой мост**, значение данного параметра рекомендуется оставить по умолчанию._  

    - Тип адаптера  

        > Тип виртуального сетевого адаптера на ВМ.  

    - Неразборчивый режим  

        > Специальный режим сетевого подключения, 
        > который позволяет ВМ перехватывать и обрабатывать весь сетевой трафик на определенном сетевом интерфейсе хостовой системы. 
        > В этом режиме ВМ невидима для остальных устройств в сети, так как ей присваивается тот же MAC-адрес, что и хосту.  
        > 
        > _Рекомендуется **Запретить**._  

    - MAC-адрес  

        > MAC-адрес интерфейса ВМ.  

    - Подключить кабель  

        > Позволяет эмулировать физическое подключение сетевого кабеля к сетевому адаптеру ВМ. 
        > Если опция выключена, сетевое соединение ВМ будет отсутствовать.  

    - Проброс портов  

        > Используется в режиме NAT для передачи трафика с определенных портов хостовой системы на порты ВМ.  

1. Нажать <span style="border:2px solid #555; border-radius:0px; width: 200px; text-align:center; padding:3px;">ОК</span>.  

---  

> Дополнительная информация об использовании **VirtualBox** доступна в [официальной документации продукта](https://www.virtualbox.org/wiki/Documentation).  
